<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>TensorFlow.js Example</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.15.0/dist/tf.min.js"></script>
</head>
<body>
  <h1>TensorFlow.js Example</h1>
  <p>Formula: y = 2x + 6</p>

  <button onclick="entrenarModelo()">Entrenar Modelo</button>
  <input type="number" id="inputX" placeholder="Ingrese valor de X" />
  <button onclick="predecir()">Predecir</button>

  <p id="resultado"></p>

  <script>
    let modelo;

    async function entrenarModelo() {
      const xs = tf.tensor2d([-6, -5, -4, -3, -2, -1, 0, 1, 2], [9, 1]);
      const ys = tf.tensor2d(xs.dataSync().map(x => 2 * x + 6), [9, 1]);

      modelo = tf.sequential();
      modelo.add(tf.layers.dense({units: 1, inputShape: [1]}));
      modelo.compile({optimizer: 'sgd', loss: 'meanSquaredError'});

      await modelo.fit(xs, ys, {
        epochs: 350,
        callbacks: {
          onTrainEnd: () => {
            document.getElementById("resultado").textContent = "Modelo entrenado. Listo para predecir.";
          }
        }
      });
    }

    function predecir() {
      if (!modelo) {
        document.getElementById("resultado").textContent = "Primero debe entrenar el modelo.";
        return;
      }

      const input = parseFloat(document.getElementById("inputX").value);
      if (isNaN(input)) {
        document.getElementById("resultado").textContent = "Ingrese un número válido para X.";
        return;
      }

      const tensor = tf.tensor2d([input], [1, 1]);
      const resultado = modelo.predict(tensor);

      resultado.array().then(array => {
        document.getElementById("resultado").textContent =
          `El resultado de predecir para ${input} es: ${array[0][0]}`;
      });
    }

    
  </script>
</body>
</html>
